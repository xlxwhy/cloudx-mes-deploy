webpackJsonp([174],{AD6z:function(t,e){},oNkO:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("Gu7T"),a=n.n(i),o=n("0e2d"),l={components:{},data:function(){var t=this.$template;return{loading:!1,query:this.$route.query,api:o.default,links:{list:{name:"factory-list"}},form:{validate:this.$handleFormValidate,entity:{},labelWidth:"120px",rules:{code:this.$rule.name("工厂编码",null,32),name:this.$rule.name("工厂名称",null,32),type:this.$rule.requireds("工厂类型不能为空"),contactName:this.$rule.lengths("联系人",0,16),contactPhone:this.$rule.mobile("联系电话",!1),address:this.$rule.lengths("联系人",0,128),remark:this.$rule.lengths("联系人",0,256)},items:[t.input("code","工厂编码"),t.input("name","工厂名称"),t.config(t.select("type","工厂类型"),{options:{adapter:function(t){return t},values:[{label:"布料工厂",value:1},{label:"纺织工厂",value:2},{label:"其他类型",value:3}]}}),t.input("contactName","联系人"),t.input("contactPhone","联系电话"),t.input("address","地址"),t.textarea("remark","备注")]},entity:{}}},created:function(){this.loadEntity()},methods:{loadEntity:function(){var t=this;this.query&&this.query.id&&(this.loading=!0,this.api.findById(this.$route.query).then(function(e){t.form.entity=e.data.body,t.loading=!1}),setTimeout(function(){t.loading=!1},2e3))},buildEntity:function(){var t,e=this.$lodash.map(this.form.items,function(t){return t.field});return(t=this.$lodash).pick.apply(t,[this.form.entity,"id"].concat(a()(e)))},handleSave:function(){var t=this,e={body:this.buildEntity(),next:"factory-list"};console.log(e);var n=this.$api.FactoryController,i=e.body.id;this.loading=!0,this.$invokeSave2(e,"id",n.add,n.modify,function(e){t.loading=!1,console.log(e.body),i||(t.form.entity.id=e.body.id)}).catch(function(e){t.loading=!1})}}},r={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"factory-container"},[n("gtmc-detail",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[n("gtmc-block",{attrs:{title:"新增工厂"}},[n("el-form",{ref:"form",attrs:{model:t.form.entity,rules:t.form.rules,"label-width":t.form.labelWidth}},[n("template-form-panel",{attrs:{form:t.form,entity:t.form.entity}})],1)],1),t._v(" "),n("div",{attrs:{slot:"button"},slot:"button"},[n("gtmc-button-save",{attrs:{name:"保存"},on:{click:function(e){return t.$handleFormValidate("form",t.handleSave)}}}),t._v(" "),n("gtmc-button-return",{attrs:{name:"取消"},on:{click:function(e){return t.link("factory-list")}}})],1)],1)],1)},staticRenderFns:[]};var s=n("VU/8")(l,r,!1,function(t){n("AD6z")},null,null);e.default=s.exports}});